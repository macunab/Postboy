
<h1>PostBoy App</h1>
<div class="container-fluid">
    <div class="row g-0 main-content">
        <!-- REQUEST CONTENT-->
        <div class="col-md-6 col-12 border bg-light">
            REQUEST
            <div class="input-group mb-3 p-1">
                <select class="form-select flex-grow-0 w-auto" aria-label="Default select example"
                    [(ngModel)]="selectedTypeRequest">
                    <option value="POST">POST</option>
                    <option value="GET">GET</option>
                    <option value="PUT">PUT</option>
                    <option value="PATH">PATH</option>
                    <option value="DELETE">DELETE</option>
                </select>
                <input type="text" class="form-control" [(ngModel)]="url" placeholder="https://www.apiurl.com/save"
                    aria-label="Username" aria-describedby="button-addon2">
                <button class="btn btn-outline-info" type="button" id="button-addon2"
                    (click)="sendRequest()">Send</button>
            </div>
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" id="query-tab" data-bs-toggle="tab" role="tab" aria-controls="home"
                        aria-selected="true" aria-current="page" href="#query-params">Query</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="headers-response-tab" data-bs-toggle="tab" role="tab"
                        aria-control="headers-response" aria-selected="false" href="#headers-response">Headers</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="body-tab" data-bs-toggle="tab" role="tab" aria-control="body"
                        aria-selected="false" href="#body">Body</a>
                </li>
            </ul>
            <div class="tab-content">
                <!-- Request Query Parameters-->
                <div class="tab-pane fade show active" aria-labelledby="query-tab" id="query-params">
                    Query Parameters
                    <button class="btn btn-outline-success" type="button" (click)="addItem('query')">Add</button>
                    <div class="row g-1 mt-1" *ngFor="let query of queryParameters; let i = index">
                        <div class="col">
                            <input type="text" class="form-control" id="key{{i}}" value="{{query.key}}"
                                [(ngModel)]="query.key">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control" id="value{{i}}" value="{{query.value}}"
                                [(ngModel)]="query.value">
                        </div>
                        <div class="col">
                            <button type="button" (click)="removeItem(i,'query')"
                                class="btn btn-outline-danger">Remove</button>
                        </div>
                    </div>

                </div>
                <!-- Request Header-->
                <div class="tab-pane fade" aria-labelledby="headers-response-tab" id="headers-response">
                    HTTP HEADERS
                    <button class="btn btn-outline-success" type="button" (click)="addItem('header')">Add</button>
                    <div class="row g-1 mt-1" *ngFor="let header of headerList; let i = index">
                        <div class="col">
                            <input type="text" class="form-control" id="key{{i}}" value="{{header.key}}"
                                [(ngModel)]="header.key">
                        </div>
                        <div class="col">
                            <input type="text" class="form-control" id="value{{i}}" value="{{header.value}}"
                                [(ngModel)]="header.value">
                        </div>
                        <div class="col">
                            <button type="button" (click)="removeItem(i, 'header')"
                                class="btn btn-outline-danger">Remove</button>
                        </div>
                    </div>
                </div>
                <!-- Request Body-->
                <div class="tab-pane fade" aria-labelledby="body-tap" id="body">
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" id="json-tab" data-bs-toggle="tab" role="tab"
                                aria-controls="json" aria-selected="true" aria-current="page" href="#json"
                                (click)="setBody('json')">JSON</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="xml-tab" data-bs-toggle="tab" role="tab" aria-control="xml"
                                aria-selected="false" href="#xml" (click)="setBody('xml')">XML</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="form-tab" data-bs-toggle="tab" role="tab" aria-control="form"
                                aria-selected="false" href="#form" (click)="setBody('form')">Form</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane fade show active" aria-labelledby="json-tap" id="json">
                            <ngs-code-editor [theme]="theme" [codeModel]="codeModel" [options]="options"
                                (valueChanged)="onCodeChanged($event)">
                            </ngs-code-editor>
                        </div>
                        <div class="tab-pane fade" aria-labelledby="xml-tap" id="xml">
                            <ngs-code-editor [theme]="theme" [codeModel]="codeModelXml" [options]="options"
                                (valueChanged)="onCodeChanged($event)">
                            </ngs-code-editor>
                        </div>
                        <div class="tab-pane fade" aria-labelledby="form-tap" id="form">
                            FORM
                            <button class="btn btn-outline-success" type="button"
                                (click)="addItem('bodyForm')">Add</button>
                            <div class="row g-1 mt-1" *ngFor="let form of bodyForm; let i = index">
                                <div class="col">
                                    <input type="text" class="form-control" id="key{{i}}" value="{{form.key}}"
                                        [(ngModel)]="form.key">
                                </div>
                                <div class="col">
                                    <input type="text" class="form-control" id="value{{i}}" value="{{form.value}}"
                                        [(ngModel)]="form.value">
                                </div>
                                <div class="col">
                                    <button type="button" (click)="removeItem(i, 'bodyForm')"
                                        class="btn btn-outline-danger">Remove</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- RESPONSE CONTENT -->
        <div class="col-md-6 col-12 border bg-light">
            RESPONSE
            <div class="row mt-3 p-1">
                <div *ngIf="loading">
                    Procesando, espere un momento...
                </div>
                <div class="row" *ngIf="!loading">
                    <p class="col-4">Status: <strong
                            [ngClass]="responseSuccess ? 'text-success' : 'text-danger'">{{responseStatus}}</strong></p>
                    <p class="col-4">Size: <strong
                            [ngClass]="responseSuccess ? 'text-success' : 'text-danger'">{{responseSize}}</strong></p>
                    <p class="col-4">Time: <strong
                            [ngClass]="responseSuccess ? 'text-success' : 'text-danger'">{{responseTime}}</strong></p>
                </div>
            </div>
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" id="response-tab" data-bs-toggle="tab" role="tab"
                        aria-control="body" aria-selected="false" href="#response">Response</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" aria-current="page" id="response-header-tap" data-bs-toggle="tab" role="tab"
                        aria-control="body" aria-selected="false" href="#response-header">Headers</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" aria-current="page" id="cookies-tab" data-bs-toggle="tab" role="tab"
                        aria-control="body" aria-selected="false" href="#cookies">Cookies</a>
                </li>
            </ul>
            <div class="tab-content">
                <!-- Response -->
                <div class="tab-pane fade show active" aria-labelledby="response-tap" id="response">
                    <pre *ngIf="!loading" class="bg-white"><p>{{responseData | json}}</p></pre>
                    <div class="mt-5 d-flex justify-content-center" *ngIf="loading">
                        <div class="spinner-border" role="status">
                        </div>
                    </div>
                </div>

                <!-- Response Header -->
                <div class="tab-pane fade" aria-labelledby="response-header-tap" id="response-header">
                    HEADERS
                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-sm table-bordered mr-5">
                                <thead>
                                    <tr>
                                        <th scope="col">Headers</th>
                                        <th scope="col">Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let header of responseHeaders">
                                        <th>{{header.key}}</th>
                                        <td>{{header.value}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Response Cookies -->
                <div class="tab-pane fade" aria-labelledby="cookies-tab" id="cookies">
                    NO COOKIES AVALAIBLE 
                </div>
            </div>
        </div>
    </div>